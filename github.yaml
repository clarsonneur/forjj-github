---
plugin: "github"
version: "0.1"
description: "Upstream github plugin for FORJJ. It properly configure github.com or entreprise with organisation/repos"
runtime:
  docker:
    image: "hub.docker.hpecorp.net/devops/forjj-github"
  service_type: "REST API"
  service:
    #socket: "github.sock"
    parameters: [ "service", "start" ]
created_flag_file: "{{ .InstanceName }}/{{.Name}}.yaml"
actions:
 common:
   flags:
     forjj-infra:
       help: "Name of the Infra repository to use"
     github-debug:
       help: "To activate github debug information"
     forjj-source-mount:
       help: "Where the source dir is located for github plugin."
     forjj-instance-name:
        help: "Name of the jenkins instance given by forjj."
     github-token:
       help: "github token to access. This token must authorize organization level access."
       required: true
       secure: true
 create:
   help: "Create the github environment to manage source and infra code."
   flags:
     github-server:
       help: "Github Entreprise Server name. By default, public 'github.com' API is used."
     forjj-organization:
       help: "Default FORJJ Organization. Used by default as github organization. If you want different one, use --github-organization"
     github-organization:
       help: "Github Organization name. By default, it uses the FORJJ organization name"
 update:
   help: "Update the github infrastructure in the infra repository."
   flags:
     github-server:
       help: "Github Entreprise Server name. By default, public 'github.com' API is used."
     forjj-organization:
       help: "Default FORJJ Organization. Used by default as github organization. If you want different one, use --github-organization"
     github-organization:
       help: "Github Organization name. By default, it uses the FORJJ organization name"
 maintain:
   help: "Maintain github infrastructure from the infra repository"
   flags:
     forjj-workspace-mount:
       help: "Where the workspace dir is located for github plugin."
objects:
  # Define github group exposure to forjj
  group:
    # Default is : actions: ["add", "update", "remove", "list", "rename"]
    help: "Manage teams in github"
    flags:
      organization:
        help: "To manage github teams at organization level"
        default: "false"
      users:
        only-for-actions: ["add"]
        help: "List of users to attach to the new group."
      add-users:
        only-for-actions: ["update"]
        help: "Add users to github team."
      remove-users:
        actions: ["update"]
        help: "remove users from github team."
      name:
        help: "group name"
        required: true
      roles:
        only-for-actions: ["add"]
        help: "List of roles to apply to the new group."
      add-roles:
        only-for-actions: ["update"]
        help: "Roles added to the group."
      remove-roles:
        only-for-actions: ["update"]
        help: "Roles removed to the group."
  # Define github users exposure to forjj
  user:
    # Default is : actions: ["add", "update", "remove", "list", "rename"]
    help: "Manage teams in github"
    flags:
      organization:
        help: "To manage github users at organization level"
        default: "false"
      name:
        help: "user name"
        required: true
      roles:
        only-for-actions: ["add"]
        help: "List of roles to apply to the new user."
      add-roles:
        only-for-actions: ["update"]
        help: "Roles added to the user."
      remove-roles:
        only-for-actions: ["update"]
        help: "Roles removed from the user."
